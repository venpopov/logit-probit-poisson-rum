<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.8.27">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="keywords" content="discrete choice, random utility, multinomial logit, multinomial probit, Poisson process, evidence accumulation">

    <title>A Poisson Count Race as a Generative Bridge Between Logit and Probit Choice</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a74871fe4945b66d259aafc266475145.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      <meta name="citation_title" content="A Poisson Count Race as a Generative Bridge Between Logit and Probit Choice">
<meta name="citation_abstract" content="This study unifies the two canonical discrete choice specifications--Multinomial Logit and Multinomial Probit--within a single generative framework. I introduce a **Poisson Count Race**, wherein $K$ alternatives generate events according to independent Poisson processes. A choice is determined when an alternative reaches a cumulative count threshold $\theta$. At the threshold $\theta=1$, the model yields the Multinomial Logit (Luce choice rule). By normalizing the utility noise to maintain a constant variance--a process termed temperature identification--I show that as $\theta \to \infty$, the model converges to the Multinomial Probit. This formulation provides a parametric bridge in which $\theta$ governs the shape of the error distribution and a separate parameter, $\beta$, modulates the temperature, while the systematic utilities $v_i$ are shared across all regimes. Crucially, this bridge arises from a single stochastic accumulation mechanism rather than from post hoc variance matching between distinct models.
">
<meta name="citation_keywords" content="discrete choice,random utility,multinomial logit,multinomial probit,Poisson process,evidence accumulation">
<meta name="citation_author" content="Vencislav Popov">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Individual choice behavior;,citation_abstract=This research monograph is devoted to a theoretical (mathematical) analysis of one of the major themes of interest to psychologists: choice. The analysis begins by stating a general axiom that may hold among the probabilities of choice from related sets of alternatives. This is shown to imply the existence of a ratio scale that is then used to analyze a number of traditional problems. The 1st subject treated is psychophysics, and covers areas involving time- and space-order effects, Fechner’s equal jnd problem, power law in psychophysics and its relation to discrimination data, psychophysical interaction between 2 independent physical variables and possible correlates with Stevens’ distinction between prothetic and metathetic continua, Thurston’s low of comparative judgment, signal detectability theory, and ranking of stimuli. The next major theme studied is utility theory. Unusual results are obtained which suggest an experiment to test the theory. Topics in learning are analyzed in a concluding chapter which uses the stochastic theories of learning as the basic approach, with the exception that distributions of response strengths are assumed to be transformed rather than response probabilities. 3 classes of learning operators emerge, both linear and nonlinear. (PsycINFO Database Record (c) 2016 APA, all rights reserved);,citation_author=R. Duncan Luce;,citation_publication_date=1959;,citation_cover_date=1959;,citation_year=1959;,citation_series_title=Individual choice behavior;">
<meta name="citation_reference" content="citation_title=Conditional logit analysis of qualitative choice behavior;,citation_author=Daniel McFadden;,citation_publication_date=1974;,citation_cover_date=1974;,citation_year=1974;,citation_inbook_title=Frontiers in econometrics;,citation_series_title=Frontiers in econometrics. - New York [u.a.] : Academic Press, ISBN 0-12-776150-0. - 1974, p. 105-142;">
<meta name="citation_reference" content="citation_title=The relationship between Luce’s Choice Axiom, Thurstone’s Theory of Comparative Judgment, and the double exponential distribution;,citation_abstract=Holman and Marley have shown that Thurstone’s Case V model becomes equivalent to the Choice Axiom if its discriminal processes are assumed to be independent double exponential random variables instead of normal ones. It is shown here that for pair comparisons, this representation is not unique; other discriminal process distributions (specifiable only in terms of their characteristic functions) also yield a model equivalent to the Choice Axiom. However, none of these models is equivalent to the Choice Axiom for triple comparisons: There the double exponential representation is unique. It is also shown that within the framework of Thurstone’s theory, the double exponential distribution, and hence the Choice Axiom, is implied by a weaker assumption, called “invariance under uniform expansions of the choice set.”;,citation_author=John Yellott;,citation_publication_date=1977-04;,citation_cover_date=1977-04;,citation_year=1977;,citation_issue=2;,citation_doi=10.1016/0022-2496(77)90026-8;,citation_issn=0022-2496;,citation_volume=15;,citation_language=en-US;,citation_journal_title=Journal of Mathematical Psychology;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=A law of comparative judgment.;,citation_abstract=A new psychological law, called the law of comparative judgment, is presented with some of its special applications in the measurement of psychological values. This law is applicable not only to the comparison of physical stimulus intensities but also to qualitative comparative judgments, such as those of excellence of specimens in an educational scale. It should be possible also to verify it on comparative judgments which involve simultaneous and successive contrast. The law is stated as follows:[Equation omitted]in which S&amp;amp;amp;lt;sub&amp;gt;1&amp;lt;/sub&amp;gt; and S&amp;lt;sub&amp;gt;2&amp;lt;/sub&amp;gt; are the psychological scale values of the two compared stimuli; x&amp;lt;sub&amp;gt;12&amp;lt;/sub&amp;gt; is the sigma value corresponding to the proportion of judgments p&amp;lt;sub&amp;gt;1&amp;lt;/sub&amp;gt; &amp;gt; p&amp;lt;sub&amp;gt;2&amp;lt;/sub&amp;gt;. $\varsigma\&amp;$lt;sub&amp;gt;1&amp;lt;/sub&amp;gt; is the discriminal dispersion of stimulus R&amp;lt;sub&amp;gt;1&amp;lt;/sub&amp;gt; and $\varsigma\&amp;$lt;sub&amp;gt;2&amp;lt;/sub&amp;gt; is the dispersion of stimulus R&amp;lt;sub&amp;gt;2&amp;lt;/sub&amp;gt;. r is the correlation between the discriminal deviations of R&amp;lt;sub&amp;gt;1&amp;lt;/sub&amp;gt; and R&amp;lt;sub&amp;gt;2&amp;lt;/sub&amp;gt; in the same judgment. This law is basic for work on Weber’s and Fechner’s laws, applies to the judgments of a single observer who compares a series of stimuli by the method of paired comparisons when no &amp;quot;equal&amp;quot; judgments are allowed, and is a rational equation for the method of constant stimuli. The law is then applied to five cases each of which involves different assumptions and different degrees of simplification of the law for practical use. The weighting of the observation equations is discussed because the observation equations obtained with the five cases are not of the same reliability and hence should not be equally weighted. (PsycINFO Database Record (c) 2016 APA, all rights reserved);,citation_author=L. L. Thurstone;,citation_publication_date=1927-07;,citation_cover_date=1927-07;,citation_year=1927;,citation_issue=4;,citation_doi=10.1037/h0070288;,citation_issn=1939-1471;,citation_volume=34;,citation_language=en-US;,citation_journal_title=Psychological Review;,citation_publisher=Psychological Review Company;">
<meta name="citation_reference" content="citation_title=Binary-Choice Constraints and Random Utility Indicators (1960);,citation_abstract=This paper contains suggestions for combining various available types of information on economic choice. There are in the main three types.;,citation_author=Jacob Marschak;,citation_editor=Jacob Marschak;,citation_publication_date=1974;,citation_cover_date=1974;,citation_year=1974;,citation_doi=10.1007/978-94-010-9276-0_9;,citation_isbn=978-94-010-9276-0;,citation_language=en-US;,citation_inbook_title=Economic Information, Decision, and Prediction: Selected Essays: Volume I Part I Economics of Decision;">
<meta name="citation_reference" content="citation_title=A Conditional Probit Model for Qualitative Choice: Discrete Decisions Recognizing Interdependence and Heterogeneous Preferences;,citation_abstract=To date, the most widely used method for empirical analysis of multiple alternative qualitative choices has been an extension of binary logit analysis called conditional logit analysis. Although this method is extremely attractive because of its computational simplicity, it is burdened with a property termed the &amp;amp;amp;quot;independence of irrelevant alternatives&amp;quot; that is quite unrealistic in many choice situations. We have proposed in this paper a computationally feasible method of estimation not constrained by the independence restriction and which allows for a much richer range of human behavior than does the conditional logit model. An important characteristic of the model is provision for correlation among the random components of utility and, as a by-product, the explicit allowance for variation in tastes across individuals for the attributes of alternatives. We have demonstrated the model and compared it with the logit one by analyzing the travel mode choice decisions of commuters to the central business district of Washington, D.C. Substantial differences are found in predictions based on the two models. The example allows three alternatives. Extension to four or five is quite feasible.;,citation_author=Jerry A. Hausman;,citation_author=David A. Wise;,citation_publication_date=1978;,citation_cover_date=1978;,citation_year=1978;,citation_fulltext_html_url=https://www.jstor.org/stable/1913909;,citation_issue=2;,citation_doi=10.2307/1913909;,citation_issn=0012-9682;,citation_volume=46;,citation_journal_title=Econometrica;,citation_publisher=[Wiley, Econometric Society];">
<meta name="citation_reference" content="citation_title=How do people build up visual memory representations from sensory evidence? Revisiting two classic models of choice;,citation_abstract=In many decision tasks, we have a set of alternative choices and are faced with the problem of how to use our latent beliefs and preferences about each alternative to make a single choice. Cognitive and decision models typically presume that beliefs and preferences are distilled to a scalar latent strength for each alternative, but it is also critical to model how people use these latent strengths to choose a single alternative. Most models follow one of two traditions to establish this link. Modern psychophysics and memory researchers make use of signal detection theory, assuming that latent strengths are perturbed by noise, and the highest resulting signal is selected. By contrast, many modern decision theoretic modeling and machine learning approaches use the softmax function (which is based on Luce’s choice axiom; Luce, 1959) to give some weight to non-maximal-strength alternatives. Despite the prominence of these two theories of choice, current approaches rarely address the connection between them, and the choice of one or the other appears more motivated by the tradition in the relevant literature than by theoretical or empirical reasons to prefer one theory to the other. The goal of the current work is to revisit this topic by elucidating which of these two models provides a better characterization of latent processes in m-alternative decision tasks, with a particular focus on memory tasks. In a set of visual memory experiments, we show that, within the same experimental design, the softmax parameter $\beta$ varies across m-alternatives, whereas the parameter d$\prime$ of the signal-detection model is stable. Together, our findings indicate that replacing softmax with signal-detection link models would yield more generalizable predictions across changes in task structure. More ambitiously, the invariance of signal detection model parameters across different tasks suggests that the parametric assumptions of these models may be more than just a mathematical convenience, but reflect something real about human decision-making.;,citation_author=Maria M. Robinson;,citation_author=Isabella C. DeStefano;,citation_author=Edward Vul;,citation_author=Timothy F. Brady;,citation_publication_date=2023-12;,citation_cover_date=2023-12;,citation_year=2023;,citation_doi=10.1016/j.jmp.2023.102805;,citation_issn=0022-2496;,citation_volume=117;,citation_language=en-US;,citation_journal_title=Journal of Mathematical Psychology;,citation_publisher=Elsevier BV;">
</head>

  <body class="quarto-notebook quarto-light">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./index.qmd" class="btn btn-primary quarto-download-embed" download="index.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A Poisson Count Race as a Generative Bridge Between Logit and Probit Choice</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Author</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Vencislav Popov </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Department of Psychology, University of Zurich
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>This study unifies the two canonical discrete choice specifications–Multinomial Logit and Multinomial Probit–within a single generative framework. I introduce a <strong>Poisson Count Race</strong>, wherein <span class="math inline">\(K\)</span> alternatives generate events according to independent Poisson processes. A choice is determined when an alternative reaches a cumulative count threshold <span class="math inline">\(\theta\)</span>. At the threshold <span class="math inline">\(\theta=1\)</span>, the model yields the Multinomial Logit (Luce choice rule). By normalizing the utility noise to maintain a constant variance–a process termed temperature identification–I show that as <span class="math inline">\(\theta \to \infty\)</span>, the model converges to the Multinomial Probit. This formulation provides a parametric bridge in which <span class="math inline">\(\theta\)</span> governs the shape of the error distribution and a separate parameter, <span class="math inline">\(\beta\)</span>, modulates the temperature, while the systematic utilities <span class="math inline">\(v_i\)</span> are shared across all regimes. Crucially, this bridge arises from a single stochastic accumulation mechanism rather than from post hoc variance matching between distinct models.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>discrete choice, random utility, multinomial logit, multinomial probit, Poisson process, evidence accumulation</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#model-overview" id="toc-model-overview" class="nav-link" data-scroll-target="#model-overview"><span class="header-section-number">1.1</span> Model overview</a></li>
  </ul></li>
  <li><a href="#the-generative-model-a-poisson-count-race" id="toc-the-generative-model-a-poisson-count-race" class="nav-link" data-scroll-target="#the-generative-model-a-poisson-count-race"><span class="header-section-number">2</span> The Generative Model: A Poisson Count Race</a>
  <ul class="collapse">
  <li><a href="#transformation-to-waiting-times" id="toc-transformation-to-waiting-times" class="nav-link" data-scroll-target="#transformation-to-waiting-times"><span class="header-section-number">2.1</span> Transformation to Waiting Times</a></li>
  <li><a href="#the-random-utility-representation" id="toc-the-random-utility-representation" class="nav-link" data-scroll-target="#the-random-utility-representation"><span class="header-section-number">2.2</span> The Random Utility Representation</a></li>
  </ul></li>
  <li><a href="#the-logit-boundary-theta-1" id="toc-the-logit-boundary-theta-1" class="nav-link" data-scroll-target="#the-logit-boundary-theta-1"><span class="header-section-number">3</span> The Logit Boundary (<span class="math inline">\(\theta = 1\)</span>)</a></li>
  <li><a href="#temperature-identification" id="toc-temperature-identification" class="nav-link" data-scroll-target="#temperature-identification"><span class="header-section-number">4</span> Temperature Identification</a></li>
  <li><a href="#the-probit-limit-theta-to-infty" id="toc-the-probit-limit-theta-to-infty" class="nav-link" data-scroll-target="#the-probit-limit-theta-to-infty"><span class="header-section-number">5</span> The Probit Limit (<span class="math inline">\(\theta \to \infty\)</span>)</a></li>
  <li><a href="#simulation-studies-binary-choice" id="toc-simulation-studies-binary-choice" class="nav-link" data-scroll-target="#simulation-studies-binary-choice"><span class="header-section-number">6</span> Simulation Studies: Binary Choice</a></li>
  <li><a href="#simulation-studies-multinomial-k-alternative-choice" id="toc-simulation-studies-multinomial-k-alternative-choice" class="nav-link" data-scroll-target="#simulation-studies-multinomial-k-alternative-choice"><span class="header-section-number">7</span> Simulation Studies: Multinomial K-alternative Choice</a>
  <ul class="collapse">
  <li><a href="#study-1-convergence-to-probit" id="toc-study-1-convergence-to-probit" class="nav-link" data-scroll-target="#study-1-convergence-to-probit"><span class="header-section-number">7.1</span> Study 1: Convergence to Probit</a></li>
  <li><a href="#study-2-choice-probability-vectors" id="toc-study-2-choice-probability-vectors" class="nav-link" data-scroll-target="#study-2-choice-probability-vectors"><span class="header-section-number">7.2</span> Study 2: Choice Probability Vectors</a></li>
  <li><a href="#study-3-set-size-scaling" id="toc-study-3-set-size-scaling" class="nav-link" data-scroll-target="#study-3-set-size-scaling"><span class="header-section-number">7.3</span> Study 3: Set-Size Scaling</a></li>
  <li><a href="#study-4-independence-of-irrelevant-alternatives" id="toc-study-4-independence-of-irrelevant-alternatives" class="nav-link" data-scroll-target="#study-4-independence-of-irrelevant-alternatives"><span class="header-section-number">7.4</span> Study 4: Independence of Irrelevant Alternatives</a></li>
  <li><a href="#study-5-parameter-invariance-across-set-size" id="toc-study-5-parameter-invariance-across-set-size" class="nav-link" data-scroll-target="#study-5-parameter-invariance-across-set-size"><span class="header-section-number">7.5</span> Study 5: Parameter Invariance Across Set Size</a></li>
  <li><a href="#study-6-distributional-shape-noise-skewness-and-kurtosis" id="toc-study-6-distributional-shape-noise-skewness-and-kurtosis" class="nav-link" data-scroll-target="#study-6-distributional-shape-noise-skewness-and-kurtosis"><span class="header-section-number">7.6</span> Study 6: Distributional Shape — Noise Skewness and Kurtosis</a></li>
  <li><a href="#study-7-robustness-across-utility-structures" id="toc-study-7-robustness-across-utility-structures" class="nav-link" data-scroll-target="#study-7-robustness-across-utility-structures"><span class="header-section-number">7.7</span> Study 7: Robustness Across Utility Structures</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">7.8</span> Summary</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">8</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#relation-to-existing-models" id="toc-relation-to-existing-models" class="nav-link" data-scroll-target="#relation-to-existing-models"><span class="header-section-number">8.1</span> Relation to existing models</a></li>
  <li><a href="#implications-for-empirical-modeling" id="toc-implications-for-empirical-modeling" class="nav-link" data-scroll-target="#implications-for-empirical-modeling"><span class="header-section-number">8.2</span> Implications for empirical modeling</a></li>
  <li><a href="#limitations-and-extensions" id="toc-limitations-and-extensions" class="nav-link" data-scroll-target="#limitations-and-extensions"><span class="header-section-number">8.3</span> Limitations and extensions</a></li>
  <li><a href="#concluding-remarks" id="toc-concluding-remarks" class="nav-link" data-scroll-target="#concluding-remarks"><span class="header-section-number">8.4</span> Concluding remarks</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Discrete choice models based on Random Utility (RU) theory <span class="citation" data-cites="mcfaddenConditionalLogitAnalysis1974">(<a href="#ref-mcfaddenConditionalLogitAnalysis1974" role="doc-biblioref">McFadden 1974</a>)</span> form a central pillar of mathematical psychology, econometrics, and cognitive science. In these models, each alternative in a choice set elicits a <em>latent</em> scalar quantity - often interpreted as strength, utility, or evidence - and the observed choices arise from a comparison of these latent quantities under stochastic variability. The general setup is surprisingly simple. Consider a decision-maker facing a set of <span class="math inline">\(K \ge 2\)</span> mutually exclusive alternatives. The utility associated with alternative <span class="math inline">\(i\)</span> can be decomposed into a systematic component, <span class="math inline">\(v_i\)</span>, and a stochastic component, <span class="math inline">\(\epsilon_i\)</span>:</p>
<p><span class="math display">\[
U_{i} = v_{i} + \epsilon_{i}, \quad i=1, \dots, K
\]</span></p>
<p>The decision-maker then selects the alternative with maximum utility:</p>
<p><span class="math display">\[
C = \arg \max_{i \in K} U_{i}
\]</span></p>
<p>Within this general framework, different assumptions about the distribution of errors, <span class="math inline">\(\epsilon_i\)</span>, determine the structure of the choice model and its predictions. Two important classes dominate the field: logit-based models, derived from Luce’s choice axiom and extreme-value theory <span class="citation" data-cites="luceIndividualChoiceBehavior1959 yellottRelationshipLucesChoice1977 mcfaddenConditionalLogitAnalysis1974">(<a href="#ref-luceIndividualChoiceBehavior1959" role="doc-biblioref">Luce 1959</a>; <a href="#ref-yellottRelationshipLucesChoice1977" role="doc-biblioref">Yellott 1977</a>; <a href="#ref-mcfaddenConditionalLogitAnalysis1974" role="doc-biblioref">McFadden 1974</a>)</span>, and probit-based models, derived from Thurstone’s Theory of comparative judgements and gaussian Signal Detection Theory <span class="citation" data-cites="robinsonHowPeopleBuild2023 thurstoneLawComparativeJudgment1927 hausmanConditionalProbitModel1978a">(<a href="#ref-robinsonHowPeopleBuild2023" role="doc-biblioref">Robinson et al. 2023</a>; <a href="#ref-thurstoneLawComparativeJudgment1927" role="doc-biblioref">Thurstone 1927</a>; <a href="#ref-hausmanConditionalProbitModel1978a" role="doc-biblioref">Hausman and Wise 1978</a>)</span>. These two model families correspond to two types of error distributions:</p>
<ol type="1">
<li><p><strong>Gumbel Errors:</strong> If the <span class="math inline">\(\epsilon_i\)</span> terms are independent and identically distributed (i.i.d.) according to a Type I Extreme Value distribution, the choice probabilities follow the <strong>Multinomial Logit (MNL)</strong> or Softmax form.</p></li>
<li><p><strong>Gaussian Errors:</strong> If the <span class="math inline">\(\epsilon_i\)</span> terms follow a Multivariate Normal distribution (potentially allowing for correlated errors across alternatives) the choice probabilities are described by the <strong>Multinomial Probit (MNP)</strong> model.</p></li>
</ol>
<p>The random utility framework thus unifies axiomatic choice models <span class="citation" data-cites="luceIndividualChoiceBehavior1959">(<a href="#ref-luceIndividualChoiceBehavior1959" role="doc-biblioref">Luce 1959</a>)</span> and measurement detection-based models <span class="citation" data-cites="thurstoneLawComparativeJudgment1927">(<a href="#ref-thurstoneLawComparativeJudgment1927" role="doc-biblioref">Thurstone 1927</a>)</span> under a single functional form. However, the unification currently stops there - the different error distributions reflect different assumptions about the generating process. As <span class="citation" data-cites="robinsonHowPeopleBuild2023">Robinson et al. (<a href="#ref-robinsonHowPeopleBuild2023" role="doc-biblioref">2023</a>)</span> recently put it, the two models “describe different ways of translating sensory evidence into decision variables.”.</p>
<p>The central question addressed in this paper is this: Can the two canonical random-utility discrete-choice specifications — multinomial logit and multinomial probit — be derived from a shared generative mechanism? Can we find a deeper unifying principle? The surprising answer is yes - both models can be derived as limit cases of a single stochastic evidence accumulation mechanism. The key distinction between the models is not the form of the utility noise itself, but the stopping rule governing how stochastic evidence is accumulated before a choice is made.”</p>
<section id="model-overview" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="model-overview"><span class="header-section-number">1.1</span> Model overview</h2>
<p>I introduce a <strong>Poisson count race</strong>, wherein each alternative generates stochastic events via an independent Poisson process. A decision is made when one alternative reaches a cumulative count threshold <span class="math inline">\(\theta\)</span>. The threshold <span class="math inline">\(\theta\)</span> thus controls how much stochastic evidence must be accumulated before commitment.</p>
<p>To compare noise <em>shape</em> across <span class="math inline">\(\theta\)</span> independently of noise <em>scale</em>, I introduce a <strong>temperature identification</strong> that standardizes the stochastic utility component to unit variance for all <span class="math inline">\(\theta\)</span>, with a separate parameter <span class="math inline">\(\beta\)</span> controlling the overall magnitude of stochasticity. With this normalization, we can establish three main results:</p>
<ol type="1">
<li>At <span class="math inline">\(\theta = 1\)</span>, this reduces exactly to the Multinomial Logit</li>
<li>For any <span class="math inline">\(\theta \ge 1\)</span>, the Poisson count race is isomorphic to a random utility model with log-Gamma noise, interpolating between Gumbel and Gaussian error distributions;</li>
<li>As <span class="math inline">\(\theta \to \infty\)</span> under temperature identification, the model converges to the Multinomial Probit.</li>
</ol>
<p>From this perspective, the familiar distinction between logit and probit reflects differences in the stopping rule governing an evidence accumulation process, rather than fundamentally distinct assumptions about decision noise. Extreme-value behavior and Gaussian behavior arise naturally as endpoint regimes of the same stochastic system.</p>
<p>The remainder of the paper formalizes this framework, presents simulations illustrating the interpolation between regimes, and discusses implications for discrete choice modeling.</p>
</section>
</section>
<section id="the-generative-model-a-poisson-count-race" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Generative Model: A Poisson Count Race</h1>
<p>Let the accumulation of evidence or preference for each alternative <span class="math inline">\(i\)</span> be modeled by independent Poisson processes, denoted <span class="math inline">\(N_i(t)\)</span>, with rate parameters <span class="math inline">\(\lambda_i &gt; 0\)</span>. <span class="math inline">\(N_i(t)\)</span> represents the number of counts accumulated for alternative <span class="math inline">\(i\)</span> until time <span class="math inline">\(t\)</span>.</p>
<p>Then, define a <strong>Count Race</strong> characterized by an integer threshold <span class="math inline">\(\theta \ge 1\)</span>. The process terminates when any single process accumulates <span class="math inline">\(\theta\)</span> events.</p>
<p><strong>Definition 1 (Stopping Time).</strong> The stopping time for the system is defined as:</p>
<p><span class="math display">\[
\tau_{\theta} = \inf \{t \ge 0 : \max_{i} N_i(t) = \theta \}
\]</span></p>
<p><strong>Definition 2 (Choice).</strong> The chosen alternative is the specific process that triggers the stopping time:</p>
<p><span class="math display">\[
C = \arg \max_{i} N_i(\tau_{\theta})
\]</span></p>
<section id="transformation-to-waiting-times" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="transformation-to-waiting-times"><span class="header-section-number">2.1</span> Transformation to Waiting Times</h2>
<p>To map this stochastic process to a utility framework, consider <span class="math inline">\(T_i^{(\theta)}\)</span>, the waiting time until the <span class="math inline">\(i\)</span>-th process records its <span class="math inline">\(\theta\)</span>-th event:</p>
<p><span class="math display">\[
T_i^{(\theta)} := \inf \{t : N_i(t) = \theta \}
\]</span></p>
<p>For a Poisson process with rate <span class="math inline">\(\lambda_i\)</span>, the waiting time to the <span class="math inline">\(\theta\)</span>-th jump follows a Gamma (Erlang) distribution:</p>
<p><span class="math display">\[
T_i^{(\theta)} \sim \text{Gamma}(\text{shape}=\theta, \text{rate}=\lambda_i)
\]</span></p>
<p>The condition that alternative <span class="math inline">\(i\)</span> “wins” the race (i.e., reaches <span class="math inline">\(\theta\)</span> events first) is equivalent to observing the minimum waiting time:</p>
<p><span class="math display">\[
C = \arg \min_{i} T_i^{(\theta)}
\]</span></p>
</section>
<section id="the-random-utility-representation" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-random-utility-representation"><span class="header-section-number">2.2</span> The Random Utility Representation</h2>
<p>Because the Poisson processes <span class="math inline">\(N_1(t), \ldots, N_K(t)\)</span> are mutually independent, the waiting times <span class="math inline">\(T_1^{(\theta)}, \ldots, T_K^{(\theta)}\)</span> are also mutually independent. By the scaling property of the Gamma distribution, each waiting time can be written as</p>
<p><span class="math display">\[
T_i^{(\theta)} \stackrel{d}{=} \frac{G_i}{\lambda_i}
\]</span></p>
<p>where <span class="math inline">\(G_1, \ldots, G_K \stackrel{\text{i.i.d.}}{\sim} \text{Gamma}(\theta, 1)\)</span> are mutually independent standard Gamma random variables. Consequently, the choice problem is formulated as:</p>
<p><span class="math display">\[
C = \arg \min_{i} \left( \frac{G_i}{\lambda_i} \right)
\]</span></p>
<p>Applying the natural logarithm, a monotonic transformation, reverses the optimization direction from minimization to maximization:</p>
<p><span class="math display">\[
\begin{aligned} C &amp;= \arg \min_{i} (\log G_i - \log \lambda_i) \\ &amp;= \arg \max_{i} (\log \lambda_i - \log G_i) \end{aligned}
\]</span></p>
<p>This establishes an exact RUM structure:</p>
<p><span class="math display">\[
U_i^{(\theta)} = v_i + \epsilon_i^{(\theta)}
\]</span></p>
<p>where:</p>
<ul>
<li><strong>Systematic Utility:</strong> <span class="math inline">\(v_i = \log \lambda_i\)</span><br>
</li>
<li><strong>Stochastic Error:</strong> <span class="math inline">\(\epsilon_i^{(\theta)} = -\log G_i\)</span>, with <span class="math inline">\(G_i \sim \text{Gamma}(\theta, 1)\)</span>.</li>
</ul>
<p>Thus, the Poisson count race is isomorphic to a Random Utility Model characterized by Log-Gamma noise.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Result 1 (Log-Gamma Random Utility Family)
</div>
</div>
<div class="callout-body-container callout-body">
<p>For any integer threshold <span class="math inline">\(\theta \ge 1\)</span>, the Poisson count race induces a random utility model <span class="math inline">\(U_i^{(\theta)} = \log \lambda_i - \log G_i\)</span> with i.i.d. log-Gamma(<span class="math inline">\(\theta\)</span>) noise. This family interpolates between Gumbel noise (<span class="math inline">\(\theta = 1\)</span>) and, under temperature identification, Gaussian noise (<span class="math inline">\(\theta \to \infty\)</span>).</p>
</div>
</div>
</section>
</section>
<section id="the-logit-boundary-theta-1" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> The Logit Boundary (<span class="math inline">\(\theta = 1\)</span>)</h1>
<p>In the specific instance where the threshold is a single event (<span class="math inline">\(\theta = 1\)</span>), the waiting time distribution simplifies:</p>
<p><span class="math display">\[
G_i \sim \text{Gamma}(1, 1) \equiv \text{Exponential}(1)
\]</span></p>
<p>A fundamental property of the Gumbel distribution is its relationship to the Exponential distribution:</p>
<p><span class="math display">\[
X \sim \text{Exp}(1) \implies -\log(X) \sim \text{Gumbel}(\text{Type I EV})
\]</span></p>
<p>Therefore, when <span class="math inline">\(\theta=1\)</span>, the noise terms <span class="math inline">\(\epsilon_i^{(1)}\)</span> are i.i.d. Gumbel. This recovers the exact Multinomial Logit formula:</p>
<p><span class="math display">\[
\Pr(C=i) = \frac{\exp(v_i)}{\sum_{j=1}^K \exp(v_j)} = \frac{\lambda_i}{\sum_{j=1}^K \lambda_j}
\]</span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Result 2 (Logit Boundary)
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Poisson count race with threshold <span class="math inline">\(\theta=1\)</span> recovers the Multinomial Logit model exactly: the noise terms are i.i.d. standard Gumbel, and the choice probabilities follow Luce’s choice rule (Softmax). This is a classic, well-known derivation.</p>
</div>
</div>
</section>
<section id="temperature-identification" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Temperature Identification</h1>
<p>For thresholds <span class="math inline">\(\theta &gt; 1\)</span>, the error distribution deviates from the Gumbel form. Furthermore, as <span class="math inline">\(\theta\)</span> increases, the variance of the error term diminishes. Specifically, for <span class="math inline">\(\epsilon^{(\theta)} = -\log G\)</span> where <span class="math inline">\(G \sim \text{Gamma}(\theta, 1)\)</span>:</p>
<p><span class="math display">\[
\begin{aligned} \mathbb{E}[\epsilon^{(\theta)}] &amp;= -\psi(\theta) \\ \text{Var}(\epsilon^{(\theta)}) &amp;= \psi_1(\theta) \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\psi(\cdot)\)</span> denotes the digamma function and <span class="math inline">\(\psi_1(\cdot)\)</span> the trigamma function.</p>
<p>As <span class="math inline">\(\theta \to \infty\)</span>, <span class="math inline">\(\psi_1(\theta) \approx 1/\theta \to 0\)</span>. In the absence of standardization, the model becomes deterministic as the stochastic noise vanishes. To facilitate comparison of error “shapes” across varying <span class="math inline">\(\theta\)</span> values, a consistent scale must be enforced. This process is referred to as <strong>Temperature Identification</strong>. Unlike conventional scale normalization, this identification preserves non-degenerate choice behavior as <span class="math inline">\(\theta\)</span> increases, allowing the large-<span class="math inline">\(\theta\)</span> limit to be meaningfully interpreted.</p>
<p>We can define the standardized noise term <span class="math inline">\(Z_i^{(\theta)}\)</span> such that it possesses zero mean and unit variance for all <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[
Z_i^{(\theta)} := \frac{\epsilon_i^{(\theta)} - \mu_\theta}{\sigma_\theta} = \frac{-\log G_i + \psi(\theta)}{\sqrt{\psi_1(\theta)}}
\]</span></p>
<p>This leads to a <strong>Temperature-Identified Family</strong> of utility models:</p>
<p><span class="math display">\[
U_i^{(\theta)} = v_i + \beta Z_i^{(\theta)}
\]</span></p>
<p>Here:</p>
<ul>
<li><span class="math inline">\(v_i\)</span> represents the systematic utility.</li>
<li><span class="math inline">\(\theta\)</span> governs the <strong>shape</strong> of the noise distribution (tail behavior).</li>
<li><span class="math inline">\(\beta\)</span> represents the <strong>temperature</strong> (the scale of noise relative to utility).</li>
</ul>
</section>
<section id="the-probit-limit-theta-to-infty" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> The Probit Limit (<span class="math inline">\(\theta \to \infty\)</span>)</h1>
<p>This section establishes the asymptotic behavior of the temperature-identified model as the count threshold increases.</p>
<p>The key observation is that <span class="math inline">\(G_i \sim \text{Gamma}(\theta, 1)\)</span> can be decomposed as a sum of <span class="math inline">\(\theta\)</span> independent exponential random variables: <span class="math inline">\(G_i = \sum_{j=1}^{\theta} E_{ij}\)</span>, where <span class="math inline">\(E_{ij} \stackrel{\text{i.i.d.}}{\sim} \text{Exp}(1)\)</span>. By the law of large numbers, <span class="math inline">\(G_i / \theta \xrightarrow{p} 1\)</span> as <span class="math inline">\(\theta \to \infty\)</span>. Applying the delta method with the function <span class="math inline">\(g(x) = -\log(x)\)</span>, we obtain</p>
<p><span class="math display">\[
\sqrt{\theta}\,(-\log G_i - (-\log \theta)) \xrightarrow{d} \mathcal{N}\bigl(0,\, [g'(1)]^2\bigr) = \mathcal{N}(0, 1).
\]</span></p>
<p>Since the standardization <span class="math inline">\(Z_i^{(\theta)} = (-\log G_i + \psi(\theta)) / \sqrt{\psi_1(\theta)}\)</span> uses <span class="math inline">\(\psi(\theta) \sim \log\theta - 1/(2\theta)\)</span> and <span class="math inline">\(\psi_1(\theta) \sim 1/\theta\)</span>, this is asymptotically equivalent. Therefore, as <span class="math inline">\(\theta \to \infty\)</span>:</p>
<p><span class="math display">\[
Z_i^{(\theta)} \xrightarrow{d} \mathcal{N}(0, 1)
\]</span></p>
<p>Consequently, the random utilities converge in distribution:</p>
<p><span class="math display">\[
(v_i + \beta Z_i^{(\theta)})_{i=1}^K \xrightarrow{d} (v_i + \beta Z_i)_{i=1}^K
\]</span></p>
<p>where <span class="math inline">\(Z_i \stackrel{i.i.d.}{\sim} \mathcal{N}(0, 1)\)</span>.</p>
<p>Given that the error terms converge to additive Gaussian noise, the choice probabilities converge to those of the Multinomial Probit model.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Result 3 (Probit Limit)
</div>
</div>
<div class="callout-body-container callout-body">
<p>As <span class="math inline">\(\theta \to \infty\)</span>, the temperature-identified Poisson count race converges to the Multinomial Probit model with noise scale <span class="math inline">\(\beta\)</span>. The standardized log-Gamma noise <span class="math inline">\(Z_i^{(\theta)} \xrightarrow{d} \mathcal{N}(0,1)\)</span>, and choice probabilities converge to their Gaussian counterparts.</p>
</div>
</div>
</section>
<section id="simulation-studies-binary-choice" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Simulation Studies: Binary Choice</h1>
<p>To illustrate how the Poisson count race family interpolates between Logit and Probit, I conducted a simulation study in the binary choice setting (<span class="math inline">\(K=2\)</span>). This setting admits closed-form choice probabilities and allows direct visual comparison with both classical models.</p>
<p>Let <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span> denote the Poisson rates of the two alternatives, and define the log-rate ratio <span class="math inline">\(x = \log(\lambda_1/\lambda_2)\)</span>. The probability that alternative 1 wins the race can be expressed in closed form using the regularized incomplete Beta function:</p>
<p><span class="math display">\[
\Pr(C = 1 \mid x, \theta) = I_{\sigma(x)}(\theta, \theta)
\]</span></p>
<p>where <span class="math inline">\(I_p(a, b)\)</span> is the regularized incomplete Beta function and <span class="math inline">\(\sigma(x) = (1 + e^{-x})^{-1}\)</span>. To see this, note that alternative 1 wins the race if and only if <span class="math inline">\(T_1^{(\theta)} &lt; T_2^{(\theta)}\)</span>, where <span class="math inline">\(T_i^{(\theta)} \sim \text{Gamma}(\theta, \lambda_i)\)</span>. Equivalently, defining <span class="math inline">\(W = T_1^{(\theta)} / (T_1^{(\theta)} + T_2^{(\theta)})\)</span>, we have <span class="math inline">\(W \sim \text{Beta}(\theta, \theta)\)</span> when evaluated at <span class="math inline">\(p = \lambda_1 / (\lambda_1 + \lambda_2) = \sigma(x)\)</span>, giving <span class="math inline">\(\Pr(T_1 &lt; T_2) = I_{\sigma(x)}(\theta, \theta)\)</span>. For <span class="math inline">\(\theta = 1\)</span>, this reduces exactly to <span class="math inline">\(\sigma(x)\)</span>, the logistic function.</p>
<p>When choice probabilities are plotted directly as a function of <span class="math inline">\(x\)</span> for increasing <span class="math inline">\(\theta\)</span>, the choice function becomes increasingly steep and converges to a step function at <span class="math inline">\(x = 0\)</span>, reflecting deterministic selection of the alternative with the larger rate. This confirms that without temperature identification, increasing the count threshold simply reduces stochasticity rather than inducing Gaussian behavior.</p>
<p>To compare noise <em>shape</em> independently of noise <em>scale</em>, I adopted the temperature identification introduced in Section 5. For binary choice, the variance of the utility noise difference is <span class="math inline">\(\text{Var}(\epsilon_1^{(\theta)} - \epsilon_2^{(\theta)}) = 2\psi_1(\theta)\)</span>. I therefore define the standardized signal <span class="math inline">\(s = x / \sqrt{2\psi_1(\theta)}\)</span>. On this variance-matched axis, the Logit reference (<span class="math inline">\(\theta = 1\)</span>) uses <span class="math inline">\(\text{sd}_{\text{diff}} = \pi/\sqrt{3}\)</span> (the standard deviation of the difference of two independent Gumbel variates), and the Probit reference is simply <span class="math inline">\(\Phi(s)\)</span>.</p>
<p>For the multinomial simulations, the same principle applies. The logit reference uses an effective inverse temperature of <span class="math inline">\(\pi / (\beta\sqrt{6})\)</span>, which ensures the Gumbel noise has standard deviation matching <span class="math inline">\(\beta\)</span> under the unit-variance convention. The probit reference uses noise scale <span class="math inline">\(\beta\)</span> directly. All simulations use <span class="math inline">\(\beta = 1\)</span> unless otherwise noted. Under this normalization, the <span class="math inline">\(\theta = 1\)</span> Poisson race coincides exactly with the variance-matched logit curve, while increasing <span class="math inline">\(\theta\)</span> yields choice functions that converge uniformly to the probit curve.</p>
<p>Because logit and probit are themselves numerically close under variance matching, the differences between models are small in absolute magnitude but systematic. To make these differences visible, <a href="#fig-residuals" class="quarto-xref">Figure&nbsp;1</a> plots residuals relative to the variance-matched Logit model. At <span class="math inline">\(\theta = 1\)</span>, the residual is identically zero (exact Logit). As <span class="math inline">\(\theta\)</span> increases, the residuals grow smoothly and converge toward the Probit<span class="math inline">\(-\)</span>Logit difference curve, with the maximum absolute deviation from probit decaying rapidly in <span class="math inline">\(\theta\)</span>. This confirms that the temperature-identified Poisson count race defines a continuous, parameterized family of choice rules that interpolates smoothly between logit-like and probit-like behavior.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div id="cell-fig-residuals" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/race_functions.R"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1200</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>thetas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Build data frame</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">s =</span> s,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">residual =</span> <span class="fu">probit_residual</span>(s),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"Probit"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (th <span class="cf">in</span> thetas) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, <span class="fu">data.frame</span>(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> s,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">race_residual</span>(s, th),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">paste0</span>(<span class="st">"θ = "</span>, th)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Order factor levels so Probit appears first, then thetas in order</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>model,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Probit"</span>, <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> residual, <span class="at">color =</span> model, <span class="at">linewidth =</span> model)) <span class="sc">+</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_manual</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Probit"</span> <span class="ot">=</span> <span class="fl">1.2</span>, <span class="fu">setNames</span>(<span class="fu">rep</span>(<span class="fl">0.6</span>, <span class="fu">length</span>(thetas)),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas)))</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Rescaled signal "</span> <span class="sc">~</span> s <span class="sc">==</span> <span class="fu">log</span>(lambda[<span class="dv">1</span>]<span class="sc">/</span>lambda[<span class="dv">2</span>]) <span class="sc">/</span> <span class="fu">sd</span>(epsilon[<span class="dv">1</span>] <span class="sc">-</span> epsilon[<span class="dv">2</span>])),</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"Residual: "</span> <span class="sc">~</span> <span class="fu">Pr</span>(choice <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">-</span> Logit[ref](s)),</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="st">"Model"</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-residuals" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-residuals-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Residuals of Poisson count race choice probabilities relative to the Logit reference, plotted on a variance-matched axis. Each curve corresponds to a different accumulation threshold θ. At θ = 1 the model is exactly Logit (zero residual). As θ increases, the curves converge toward the Probit − Logit difference (black curve), confirming the theoretical bridge between the two models."><img src="index_files/figure-html/fig-residuals-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Residuals of Poisson count race choice probabilities relative to the Logit reference, plotted on a variance-matched axis. Each curve corresponds to a different accumulation threshold θ. At θ = 1 the model is exactly Logit (zero residual). As θ increases, the curves converge toward the Probit − Logit difference (black curve), confirming the theoretical bridge between the two models.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="simulation-studies-multinomial-k-alternative-choice" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Simulation Studies: Multinomial K-alternative Choice</h1>
<p>The binary simulation demonstrates that the temperature-identified Poisson count race interpolates smoothly between Logit (<span class="math inline">\(\theta = 1\)</span>) and Probit (<span class="math inline">\(\theta \to \infty\)</span>) in the two-alternative case. Here I extend this analysis to the multinomial setting (<span class="math inline">\(K &gt; 2\)</span>), where the differences between logit and probit become richer and more consequential.</p>
<p>In the binary case, logit and probit choice functions differ only in the shape of the psychometric curve—a subtle quantitative distinction. With three or more alternatives, additional qualitative differences emerge. Most prominently, the Multinomial Logit model satisfies the <em>Independence of Irrelevant Alternatives</em> (IIA) property: the ratio of choice probabilities for any two alternatives is independent of the remaining alternatives in the choice set <span class="citation" data-cites="HausmanMcFadden1984">(<a href="#ref-HausmanMcFadden1984" role="doc-biblioref"><strong>HausmanMcFadden1984?</strong></a>)</span>. The Multinomial Probit model, even with independent errors, does not share this property. The Poisson count race therefore provides a window into how IIA-like behavior gradually weakens as the noise distribution transitions from Gumbel to Gaussian.</p>
<p>The multinomial simulations are organised around five questions:</p>
<ol type="1">
<li><strong>Convergence</strong>: How quickly do Poisson count race choice probabilities converge to the Probit reference as <span class="math inline">\(\theta\)</span> increases, and does the rate of convergence depend on <span class="math inline">\(K\)</span>?</li>
<li><strong>Probability vectors</strong>: How does the full distribution over alternatives change as <span class="math inline">\(\theta\)</span> varies from 1 to large values?</li>
<li><strong>Set-size scaling</strong>: How does the probability of choosing a target alternative scale with the number of competitors, and how does this scaling differ between logit, probit, and intermediate regimes?</li>
<li><strong>Independence of Irrelevant Alternatives</strong>: How does the IIA property—exact under logit—erode as <span class="math inline">\(\theta\)</span> increases toward the probit regime?</li>
<li><strong>Parameter invariance</strong>: When misspecified logit or probit models are fit to Poisson count race data, which model yields parameters that are invariant to <span class="math inline">\(K\)</span>?</li>
</ol>
<p>All simulations use Monte Carlo sampling with <span class="math inline">\(10^6\)</span> to <span class="math inline">\(10^7\)</span> replications per condition unless otherwise noted.</p>
<section id="study-1-convergence-to-probit" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="study-1-convergence-to-probit"><span class="header-section-number">7.1</span> Study 1: Convergence to Probit</h2>
<p>I first examine how the total variation (TV) distance between the Poisson count race choice probabilities and the Logit / Probit references changes as a function of <span class="math inline">\(\theta\)</span>, for different numbers of alternatives <span class="math inline">\(K\)</span>.</p>
<p>For each <span class="math inline">\(K\)</span>, I use linearly spaced utilities <span class="math inline">\(v_i = (K - i)/(K - 1)\)</span> for <span class="math inline">\(i = 1, \ldots, K\)</span>, ensuring that the best and worst alternatives always have utilities 1 and 0 regardless of <span class="math inline">\(K\)</span>. The temperature is fixed at <span class="math inline">\(\beta = 1\)</span>.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="cell-fig-tv-distance" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">1e7</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Ks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>thetas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (K <span class="cf">in</span> Ks) {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="at">length.out =</span> K)  <span class="co"># linearly spaced utilities</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reference models</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  p_logit <span class="ot">&lt;-</span> <span class="fu">mnl_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  p_probit <span class="ot">&lt;-</span> <span class="fu">mnp_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> <span class="fl">2e6</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (th <span class="cf">in</span> thetas) {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    p_race <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">K =</span> K,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">theta =</span> th,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">tv_logit =</span> <span class="fu">tv_dist</span>(p_race, p_logit),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">tv_probit =</span> <span class="fu">tv_dist</span>(p_race, p_probit)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape for plotting</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>df_tv <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">K =</span> results<span class="sc">$</span>K, <span class="at">theta =</span> results<span class="sc">$</span>theta, </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">TV =</span> results<span class="sc">$</span>tv_logit, <span class="at">Reference =</span> <span class="st">"vs. Logit"</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">K =</span> results<span class="sc">$</span>K, <span class="at">theta =</span> results<span class="sc">$</span>theta, </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">TV =</span> results<span class="sc">$</span>tv_probit, <span class="at">Reference =</span> <span class="st">"vs. Probit"</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>df_tv<span class="sc">$</span>K_label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"K = "</span>, df_tv<span class="sc">$</span>K)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>df_tv<span class="sc">$</span>K_label <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_tv<span class="sc">$</span>K_label, <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">"K = "</span>, Ks))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_tv, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> TV, <span class="at">color =</span> Reference)) <span class="sc">+</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>K_label) <span class="sc">+</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"vs. Logit"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"vs. Probit"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>)) <span class="sc">+</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Threshold "</span> <span class="sc">*</span> theta),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total variation distance"</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Reference"</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-tv-distance" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tv-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-tv-distance-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Total variation distance between Poisson count race choice probabilities and the Logit (blue) and Probit (red) references, as a function of threshold θ, for different numbers of alternatives K."><img src="index_files/figure-html/fig-tv-distance-1.png" class="img-fluid figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tv-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Total variation distance between Poisson count race choice probabilities and the Logit (blue) and Probit (red) references, as a function of threshold θ, for different numbers of alternatives K.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="study-2-choice-probability-vectors" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="study-2-choice-probability-vectors"><span class="header-section-number">7.2</span> Study 2: Choice Probability Vectors</h2>
<p>To visualise how the full distribution over alternatives evolves with <span class="math inline">\(\theta\)</span>, I fix <span class="math inline">\(K = 5\)</span> with utilities <span class="math inline">\(v = (2.0,\; 1.5,\; 1.0,\; 0.5,\; 0.0)\)</span> and plot the choice probability for each alternative across a range of thresholds.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="cell-fig-prob-vectors" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="at">length.out =</span> K)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>thetas_fine <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">2e6</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># References</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>p_logit <span class="ot">&lt;-</span> <span class="fu">mnl_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>p_probit <span class="ot">&lt;-</span> <span class="fu">mnp_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> <span class="fl">5e6</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Race probabilities across theta</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>df_probs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (th <span class="cf">in</span> thetas_fine) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    df_probs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_probs, <span class="fu">data.frame</span>(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">theta =</span> th,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">alternative =</span> <span class="fu">paste0</span>(<span class="st">"Alt "</span>, i, <span class="st">" (v="</span>, v[i], <span class="st">")"</span>),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">prob =</span> p[i]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Reference data</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>df_ref <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  df_ref <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_ref, <span class="fu">data.frame</span>(</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="fu">paste0</span>(<span class="st">"Alt "</span>, i, <span class="st">" (v="</span>, v[i], <span class="st">")"</span>),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">logit =</span> p_logit[i],</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">probit =</span> p_probit[i]</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>df_probs<span class="sc">$</span>alternative <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_probs<span class="sc">$</span>alternative, </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">"Alt "</span>, <span class="dv">1</span><span class="sc">:</span>K, <span class="st">" (v="</span>, v, <span class="st">")"</span>))</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>df_ref<span class="sc">$</span>alternative <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_ref<span class="sc">$</span>alternative,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">"Alt "</span>, <span class="dv">1</span><span class="sc">:</span>K, <span class="st">" (v="</span>, v, <span class="st">")"</span>))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_probs, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> prob, <span class="at">color =</span> alternative)) <span class="sc">+</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> df_ref, <span class="fu">aes</span>(<span class="at">yintercept =</span> logit, <span class="at">color =</span> alternative), </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> df_ref, <span class="fu">aes</span>(<span class="at">yintercept =</span> probit, <span class="at">color =</span> alternative), </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Threshold "</span> <span class="sc">*</span> theta),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Choice probability"</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Alternative"</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">250</span>, <span class="at">y =</span> <span class="fu">max</span>(p_logit) <span class="sc">+</span> <span class="fl">0.01</span>, <span class="at">label =</span> <span class="st">"— Logit    ··· Probit"</span>, </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-prob-vectors" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-prob-vectors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-prob-vectors-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Choice probabilities for each of five alternatives as a function of threshold θ. Dashed lines: Logit reference; dotted lines: Probit reference."><img src="index_files/figure-html/fig-prob-vectors-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prob-vectors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Choice probabilities for each of five alternatives as a function of threshold θ. Dashed lines: Logit reference; dotted lines: Probit reference.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="study-3-set-size-scaling" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="study-3-set-size-scaling"><span class="header-section-number">7.3</span> Study 3: Set-Size Scaling</h2>
<p>A critical diagnostic for discriminating between logit and probit models is the effect of adding alternatives to the choice set <span class="citation" data-cites="Robinson2023">(<a href="#ref-Robinson2023" role="doc-biblioref"><strong>Robinson2023?</strong></a>)</span>. Under MNL, the probability of choosing a target alternative with fixed utility is strictly determined by the ratio of its strength to the total strength. Under MNP, the scaling with set size differs because the probability of “winning” the maximum comparison depends on the shape of the noise distribution.</p>
<p>I fix a target alternative with utility <span class="math inline">\(v_\text{target} = 1\)</span> and add <span class="math inline">\(K - 1\)</span> equal competitors, each with utility <span class="math inline">\(v_\text{comp} = 0\)</span>. As <span class="math inline">\(K\)</span> grows, I track the probability of choosing the target.</p>
<p>Under MNL, the choice probability is <span class="math inline">\(P(\text{target}) = e^a / (e^a + K - 1)\)</span>, where <span class="math inline">\(a = v_t \cdot \pi / (\beta \sqrt{6})\)</span> is the effective scaled utility.</p>
<p>Under MNP: <span class="math inline">\(P(\text{target}) = \int \phi(z) \,\Phi(v_t/\beta + z)^{K-1}\, dz\)</span> (by symmetry of the <span class="math inline">\(K - 1\)</span> equal competitors). This integral reveals that probit’s thinner tails give the target a larger advantage over many competitors than logit’s heavier tails.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div id="cell-fig-set-size" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">2e6</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Ks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>thetas_set <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>v_target <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>v_comp <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>df_setsize <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (K <span class="cf">in</span> Ks) {</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">c</span>(v_target, <span class="fu">rep</span>(v_comp, K <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># References</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  p_logit_target <span class="ot">&lt;-</span> <span class="fu">mnl_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  p_probit_target <span class="ot">&lt;-</span> <span class="fu">mnp_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)[<span class="dv">1</span>]</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  df_setsize <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_setsize, <span class="fu">data.frame</span>(</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">K =</span> K, <span class="at">theta =</span> <span class="cn">NA</span>, <span class="at">prob =</span> p_logit_target, <span class="at">model =</span> <span class="st">"Logit (MNL)"</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  df_setsize <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_setsize, <span class="fu">data.frame</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">K =</span> K, <span class="at">theta =</span> <span class="cn">NA</span>, <span class="at">prob =</span> p_probit_target, <span class="at">model =</span> <span class="st">"Probit (MNP)"</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (th <span class="cf">in</span> thetas_set) {</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    p_race <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    df_setsize <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_setsize, <span class="fu">data.frame</span>(</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">K =</span> K, <span class="at">theta =</span> th, <span class="at">prob =</span> p_race[<span class="dv">1</span>], <span class="at">model =</span> <span class="fu">paste0</span>(<span class="st">"θ = "</span>, th)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate reference and race data</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>df_ref_lines <span class="ot">&lt;-</span> df_setsize[df_setsize<span class="sc">$</span>model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Logit (MNL)"</span>, <span class="st">"Probit (MNP)"</span>), ]</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>df_race_lines <span class="ot">&lt;-</span> df_setsize[<span class="sc">!</span>df_setsize<span class="sc">$</span>model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Logit (MNL)"</span>, <span class="st">"Probit (MNP)"</span>), ]</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>df_race_lines<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_race_lines<span class="sc">$</span>model, </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas_set))</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_ref_lines, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> prob, <span class="at">color =</span> model), </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_ref_lines, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> prob, <span class="at">color =</span> model), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_race_lines, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> prob, <span class="at">group =</span> model, <span class="at">color =</span> model), </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_race_lines, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> prob, <span class="at">color =</span> model), <span class="at">size =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Logit (MNL)"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Probit (MNP)"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setNames</span>(scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(thetas_set)), <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas_set))</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of alternatives K"</span>,</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"P(target chosen)"</span>),</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-set-size" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-set-size-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-set-size-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Probability of choosing a target alternative (v = 1) against K − 1 equal competitors (v = 0) as a function of set size K. MNL (dashed blue) and MNP (dashed red) references are shown."><img src="index_files/figure-html/fig-set-size-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-set-size-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Probability of choosing a target alternative (v = 1) against K − 1 equal competitors (v = 0) as a function of set size K. MNL (dashed blue) and MNP (dashed red) references are shown.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="study-4-independence-of-irrelevant-alternatives" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="study-4-independence-of-irrelevant-alternatives"><span class="header-section-number">7.4</span> Study 4: Independence of Irrelevant Alternatives</h2>
<p>The IIA property is a hallmark of the Multinomial Logit model: the ratio of choice probabilities for any two alternatives is invariant to the composition of the choice set. Formally, for alternatives <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[\frac{P(i \mid \mathcal{C})}{P(j \mid \mathcal{C})} = \frac{e^{v_i}}{e^{v_j}} \quad \text{for all choice sets } \mathcal{C} \ni i, j\]</span></p>
<p>This property does not hold for the Multinomial Probit model, even when errors are independent and identically distributed. The Poisson count race therefore provides a mechanism through which IIA holds exactly at <span class="math inline">\(\theta = 1\)</span> and is progressively violated as <span class="math inline">\(\theta\)</span> increases.</p>
<p>To quantify this, I consider three alternatives with utilities <span class="math inline">\(v = (2, 1, 0)\)</span>. I compute the ratio <span class="math inline">\(P(1)/P(2)\)</span> under two conditions:</p>
<ul>
<li><strong>Full set</strong>: all three alternatives present <span class="math inline">\(\{1, 2, 3\}\)</span></li>
<li><strong>Reduced set</strong>: only alternatives <span class="math inline">\(\{1, 2\}\)</span> present</li>
</ul>
<p>Under IIA, these ratios should be identical. I track the percentage change in the ratio as <span class="math inline">\(\theta\)</span> varies.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div id="cell-fig-iia" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">1e7</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>v_full <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>v_reduced <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>thetas_iia <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df_iia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (th <span class="cf">in</span> thetas_iia) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Full set {1, 2, 3}</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  p_full <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v_full, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  ratio_full <span class="ot">&lt;-</span> p_full[<span class="dv">1</span>] <span class="sc">/</span> p_full[<span class="dv">2</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reduced set {1, 2}</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  p_reduced <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v_reduced, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  ratio_reduced <span class="ot">&lt;-</span> p_reduced[<span class="dv">1</span>] <span class="sc">/</span> p_reduced[<span class="dv">2</span>]</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  df_iia <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_iia, <span class="fu">data.frame</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> th,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_full =</span> ratio_full,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_reduced =</span> ratio_reduced,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_change =</span> <span class="dv">100</span> <span class="sc">*</span> (ratio_reduced <span class="sc">-</span> ratio_full) <span class="sc">/</span> ratio_full</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Also compute reference values</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>p_logit_full <span class="ot">&lt;-</span> <span class="fu">mnl_probs</span>(v_full)[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">mnl_probs</span>(v_full)[<span class="dv">2</span>]</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>p_logit_reduced <span class="ot">&lt;-</span> <span class="fu">mnl_probs</span>(v_reduced)[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">mnl_probs</span>(v_reduced)[<span class="dv">2</span>]</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>p_probit_full <span class="ot">&lt;-</span> <span class="fu">mnp_probs</span>(v_full, <span class="at">n_sim =</span> <span class="fl">5e6</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>r_probit_full <span class="ot">&lt;-</span> p_probit_full[<span class="dv">1</span>] <span class="sc">/</span> p_probit_full[<span class="dv">2</span>]</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>p_probit_reduced <span class="ot">&lt;-</span> <span class="fu">mnp_probs</span>(v_reduced, <span class="at">n_sim =</span> <span class="fl">5e6</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>r_probit_reduced <span class="ot">&lt;-</span> p_probit_reduced[<span class="dv">1</span>] <span class="sc">/</span> p_probit_reduced[<span class="dv">2</span>]</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>probit_pct <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (r_probit_reduced <span class="sc">-</span> r_probit_full) <span class="sc">/</span> r_probit_full</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Left panel: ratios</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>df_ratios <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> df_iia<span class="sc">$</span>theta, <span class="at">ratio =</span> df_iia<span class="sc">$</span>ratio_full, </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">set =</span> <span class="st">"Full {1, 2, 3}"</span>),</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> df_iia<span class="sc">$</span>theta, <span class="at">ratio =</span> df_iia<span class="sc">$</span>ratio_reduced, </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">set =</span> <span class="st">"Reduced {1, 2}"</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_ratios, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> ratio, <span class="at">color =</span> set, <span class="at">linetype =</span> set)) <span class="sc">+</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Full {1, 2, 3}"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"Reduced {1, 2}"</span> <span class="ot">=</span> <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Full {1, 2, 3}"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"Reduced {1, 2}"</span> <span class="ot">=</span> <span class="st">"darkorange"</span>)) <span class="sc">+</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Threshold "</span> <span class="sc">*</span> theta),</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"P(Alt 1) / P(Alt 2)"</span>,</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Choice set"</span>,</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Choice set"</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Right panel: IIA violation</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_iia, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> pct_change)) <span class="sc">+</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> probit_pct, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"Logit (IIA)"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> probit_pct <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"Probit limit"</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>, </span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Threshold "</span> <span class="sc">*</span> theta),</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% change in P(1)/P(2)</span><span class="sc">\n</span><span class="st">when Alt 3 removed"</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-iia" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-iia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-iia-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Test of IIA. Left: the ratio P(Alt 1)/P(Alt 2) in the full set {1, 2, 3} (solid) and reduced set {1, 2} (dashed). Right: percentage change in the ratio when alternative 3 is removed."><img src="index_files/figure-html/fig-iia-1.png" class="img-fluid figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Test of IIA. Left: the ratio P(Alt 1)/P(Alt 2) in the full set {1, 2, 3} (solid) and reduced set {1, 2} (dashed). Right: percentage change in the ratio when alternative 3 is removed.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="study-5-parameter-invariance-across-set-size" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="study-5-parameter-invariance-across-set-size"><span class="header-section-number">7.5</span> Study 5: Parameter Invariance Across Set Size</h2>
<p>A key empirical diagnostic for distinguishing between logit and probit is parameter invariance across changes in set size <span class="math inline">\(K\)</span> <span class="citation" data-cites="Robinson2023">(<a href="#ref-Robinson2023" role="doc-biblioref"><strong>Robinson2023?</strong></a>)</span>. If choice data are generated by a logit model, the softmax inverse temperature <span class="math inline">\(\beta_{\text{logit}}\)</span> recovered from fitting a logit specification should remain constant as <span class="math inline">\(K\)</span> increases. Conversely, if the data follow a probit model, the Gaussian noise scale <span class="math inline">\(\beta_{\text{probit}}\)</span> should be invariant to <span class="math inline">\(K\)</span>.</p>
<p>I test this directly. For each value of <span class="math inline">\(\theta\)</span> and each set size <span class="math inline">\(K\)</span> (with a target at <span class="math inline">\(v = 1\)</span> vs.&nbsp;<span class="math inline">\(K-1\)</span> equal competitors at <span class="math inline">\(v = 0\)</span>), I compute the “true” choice probability <span class="math inline">\(P(\text{target})\)</span> from the race model and then recover the best-fitting logit and probit temperature parameters by inversion.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div id="cell-fig-parameter-recovery" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">303</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">3e6</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Ks_param <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>thetas_param <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>v_target <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sigma_G <span class="ot">&lt;-</span> pi <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">6</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>df_param <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (th <span class="cf">in</span> thetas_param) {</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (K <span class="cf">in</span> Ks_param) {</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">c</span>(v_target, <span class="fu">rep</span>(<span class="dv">0</span>, K <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    p_race <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)[<span class="dv">1</span>]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    beta_logit <span class="ot">&lt;-</span> <span class="fu">recover_logit_beta</span>(p_race, v_target, K)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    beta_probit <span class="ot">&lt;-</span> <span class="fu">recover_probit_beta</span>(p_race, v_target, K)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    df_param <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_param, <span class="fu">data.frame</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">K =</span> K, <span class="at">theta =</span> th, </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta_logit =</span> beta_logit, </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta_probit =</span> beta_probit,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">model_label =</span> <span class="fu">paste0</span>(<span class="st">"θ = "</span>, th)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>df_param<span class="sc">$</span>model_label <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_param<span class="sc">$</span>model_label, </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas_param))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape for faceting</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>df_param_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">K =</span> df_param<span class="sc">$</span>K, <span class="at">theta_label =</span> df_param<span class="sc">$</span>model_label,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">beta =</span> df_param<span class="sc">$</span>beta_logit, <span class="at">recovery =</span> <span class="st">"Logit recovery (β_L)"</span>),</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">K =</span> df_param<span class="sc">$</span>K, <span class="at">theta_label =</span> df_param<span class="sc">$</span>model_label,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">beta =</span> df_param<span class="sc">$</span>beta_probit, <span class="at">recovery =</span> <span class="st">"Probit recovery (β_P)"</span>)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_param_long, <span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> beta, <span class="at">color =</span> theta_label)) <span class="sc">+</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey50"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>recovery, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of alternatives K"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"Recovered "</span> <span class="sc">*</span> beta),</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Threshold"</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-parameter-recovery" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parameter-recovery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-parameter-recovery-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Recovered temperature parameters under logit (left) and probit (right) model assumptions as a function of set size K and accumulation threshold θ."><img src="index_files/figure-html/fig-parameter-recovery-1.png" class="img-fluid figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parameter-recovery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Recovered temperature parameters under logit (left) and probit (right) model assumptions as a function of set size K and accumulation threshold θ.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="study-6-distributional-shape-noise-skewness-and-kurtosis" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="study-6-distributional-shape-noise-skewness-and-kurtosis"><span class="header-section-number">7.6</span> Study 6: Distributional Shape — Noise Skewness and Kurtosis</h2>
<p>The log-Gamma noise distribution transitions from highly skewed (Gumbel, <span class="math inline">\(\theta = 1\)</span>) to symmetric (Gaussian, <span class="math inline">\(\theta \to \infty\)</span>). This transition in distributional shape underlies all the choice-level phenomena documented above. To make this explicit, I plot the standardised noise density for several values of <span class="math inline">\(\theta\)</span> alongside the standard normal reference.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div id="cell-fig-noise-densities" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n_draw <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>thetas_dens <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>df_dens <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (th <span class="cf">in</span> thetas_dens) {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  G <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n_draw, <span class="at">shape =</span> th, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(G)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> (eps <span class="sc">+</span> <span class="fu">digamma</span>(th)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">trigamma</span>(th))  <span class="co"># note: +digamma because E[eps] = -digamma</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use density estimation</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">density</span>(Z, <span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">512</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  df_dens <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_dens, <span class="fu">data.frame</span>(</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> d<span class="sc">$</span>x, <span class="at">y =</span> d<span class="sc">$</span>y, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">paste0</span>(<span class="st">"θ = "</span>, th)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal reference</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>x_norm <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">512</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>df_dens <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_dens, <span class="fu">data.frame</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_norm, <span class="at">y =</span> <span class="fu">dnorm</span>(x_norm), <span class="at">model =</span> <span class="st">"N(0,1)"</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>df_dens<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_dens<span class="sc">$</span>model, </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas_dens), <span class="st">"N(0,1)"</span>))</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_dens, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> model, <span class="at">linetype =</span> model, <span class="at">linewidth =</span> model)) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="fu">setNames</span>(<span class="fu">rep</span>(<span class="st">"solid"</span>, <span class="fu">length</span>(thetas_dens)), <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas_dens)),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>               <span class="st">"N(0,1)"</span> <span class="ot">=</span> <span class="st">"dashed"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_manual</span>(</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="fu">setNames</span>(<span class="fu">rep</span>(<span class="fl">0.7</span>, <span class="fu">length</span>(thetas_dens)), <span class="fu">paste0</span>(<span class="st">"θ = "</span>, thetas_dens)),</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>               <span class="st">"N(0,1)"</span> <span class="ot">=</span> <span class="fl">1.0</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Standardised noise "</span> <span class="sc">*</span> Z<span class="sc">^</span>(theta)),</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span>, <span class="at">linetype =</span> <span class="st">"Model"</span>, <span class="at">linewidth =</span> <span class="st">"Model"</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-noise-densities" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-noise-densities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-noise-densities-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Standardised noise densities for selected values of θ. As θ increases, the density converges to the standard normal (black dashed)."><img src="index_files/figure-html/fig-noise-densities-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-noise-densities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Standardised noise densities for selected values of θ. As θ increases, the density converges to the standard normal (black dashed).
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div id="cell-fig-skew-kurtosis" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact skewness and kurtosis of -log(Gamma(theta,1)), standardised</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness = psi_2(theta) / psi_1(theta)^(3/2) where psi_2 is the tetragamma</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Excess kurtosis = psi_3(theta) / psi_1(theta)^2 where psi_3 is the pentagamma</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: psigamma(x, deriv=n) gives the n-th derivative of log Gamma</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># psi_1 = trigamma, psi_2 = psigamma(,2), psi_3 = psigamma(,3)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>thetas_moments <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">psigamma</span>(thetas_moments, <span class="at">deriv =</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">trigamma</span>(thetas_moments)<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: -log(G) has skewness = -psi_2 / psi_1^{3/2} (the negative sign because of -log)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Actually: let's be careful. For X = -log(G), E[(X-mu)^3] = -psi_2(theta)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and Var(X) = psi_1(theta), so skewness = -psi_2(theta) / psi_1(theta)^{3/2}</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Excess kurtosis: E[(X-mu)^4]/Var^2 - 3 = psi_3(theta)/psi_1(theta)^2</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>ex_kurtosis <span class="ot">&lt;-</span> <span class="fu">psigamma</span>(thetas_moments, <span class="at">deriv =</span> <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">trigamma</span>(thetas_moments)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>df_moments <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> thetas_moments, <span class="at">value =</span> skewness, <span class="at">moment =</span> <span class="st">"Skewness"</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> thetas_moments, <span class="at">value =</span> ex_kurtosis, <span class="at">moment =</span> <span class="st">"Excess kurtosis"</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_moments, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>moment, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Threshold "</span> <span class="sc">*</span> theta),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Value"</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-skew-kurtosis" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-skew-kurtosis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-skew-kurtosis-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Skewness and excess kurtosis of the standardised log-Gamma noise as a function of θ. Both moments converge to zero (the Gaussian values) as θ increases, with skewness decaying as O(θ^{-1/2}) and excess kurtosis as O(θ^{-1}). These moment trajectories fully characterise the transition from Gumbel to Gaussian noise shape."><img src="index_files/figure-html/fig-skew-kurtosis-1.png" class="img-fluid figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-skew-kurtosis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Skewness and excess kurtosis of the standardised log-Gamma noise as a function of θ. Both moments converge to zero (the Gaussian values) as θ increases, with skewness decaying as O(θ^{-1/2}) and excess kurtosis as O(θ^{-1}). These moment trajectories fully characterise the transition from Gumbel to Gaussian noise shape.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="study-7-robustness-across-utility-structures" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="study-7-robustness-across-utility-structures"><span class="header-section-number">7.7</span> Study 7: Robustness Across Utility Structures</h2>
<p>The preceding studies used specific utility vectors. To assess robustness, I examine whether the convergence pattern holds across different utility configurations that are common in psychological experiments.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div id="cell-fig-robustness" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">2e6</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>configs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Uniform"</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, K),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Dominant"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fu">rep</span>(<span class="dv">0</span>, K <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Linear"</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="at">length.out =</span> K),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Clustered"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>thetas_robust <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>df_robust <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cfg_name <span class="cf">in</span> <span class="fu">names</span>(configs)) {</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> configs[[cfg_name]]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  p_probit <span class="ot">&lt;-</span> <span class="fu">mnp_probs</span>(v, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> <span class="fl">5e6</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (th <span class="cf">in</span> thetas_robust) {</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    p_race <span class="ot">&lt;-</span> <span class="fu">race_choice_probs</span>(v, <span class="at">theta =</span> th, <span class="at">beta =</span> <span class="dv">1</span>, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    df_robust <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_robust, <span class="fu">data.frame</span>(</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">theta =</span> th,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">tv_probit =</span> <span class="fu">tv_dist</span>(p_race, p_probit),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">config =</span> cfg_name</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>df_robust<span class="sc">$</span>config <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_robust<span class="sc">$</span>config, <span class="at">levels =</span> <span class="fu">names</span>(configs))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_robust, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> tv_probit, <span class="at">color =</span> config)) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Threshold "</span> <span class="sc">*</span> theta),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"TV distance from Probit"</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Utility structure"</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-robustness" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-robustness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-robustness-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Total variation distance from Probit as a function of θ for K = 5 alternatives under four utility structures: uniform, dominant, linear, and clustered."><img src="index_files/figure-html/fig-robustness-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-robustness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Total variation distance from Probit as a function of θ for K = 5 alternatives under four utility structures: uniform, dominant, linear, and clustered.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="summary" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="summary"><span class="header-section-number">7.8</span> Summary</h2>
<p>These multinomial simulations confirm and extend the binary-case results:</p>
<ol type="1">
<li><p><strong>Convergence is gradual and universal</strong>: Across different values of <span class="math inline">\(K\)</span> and different utility structures, the Poisson count race converges to the Multinomial Probit reference within <span class="math inline">\(\theta \approx 50\)</span>–<span class="math inline">\(100\)</span> in total variation distance.</p></li>
<li><p><strong>Probability redistribution</strong>: As <span class="math inline">\(\theta\)</span> increases, the probit model concentrates more probability on the best alternative and less on inferior alternatives, reflecting the thinner tails of Gaussian noise relative to Gumbel.</p></li>
<li><p><strong>Set-size scaling</strong>: The logit and probit models predict systematically different scaling of target choice probability with the number of competitors. The Poisson count race interpolates between these two patterns, connecting to the empirical findings of <span class="citation" data-cites="Robinson2023">(<a href="#ref-Robinson2023" role="doc-biblioref"><strong>Robinson2023?</strong></a>)</span>.</p></li>
<li><p><strong>IIA erosion</strong>: The Independence of Irrelevant Alternatives property, which holds exactly at <span class="math inline">\(\theta = 1\)</span>, is progressively violated as <span class="math inline">\(\theta\)</span> increases. This provides a process-level account of why IIA holds for logit but not probit: it is a consequence of the Gumbel noise shape, and alternative noise shapes—induced by higher accumulation thresholds—do not preserve it.</p></li>
<li><p><strong>Parameter invariance</strong>: When choice data generated by the Poisson count race are fit under a logit assumption, the recovered inverse temperature drifts with set size <span class="math inline">\(K\)</span> for all <span class="math inline">\(\theta &gt; 1\)</span>. Conversely, when fit under a probit assumption, the recovered noise scale remains stable for large <span class="math inline">\(\theta\)</span> but drifts when <span class="math inline">\(\theta\)</span> is small. This cross-over in parameter invariance provides a process-level account of the empirical findings of <span class="citation" data-cites="Robinson2023">(<a href="#ref-Robinson2023" role="doc-biblioref"><strong>Robinson2023?</strong></a>)</span>: parameter stability across <span class="math inline">\(K\)</span> is diagnostic of whether the effective noise distribution is closer to Gumbel or Gaussian.</p></li>
<li><p><strong>Noise shape transition</strong>: The underlying mechanism is a smooth transition in the shape of the standardised noise distribution, from the skewed Gumbel (<span class="math inline">\(\theta = 1\)</span>) to the symmetric Gaussian (<span class="math inline">\(\theta \to \infty\)</span>). The skewness and kurtosis decay at known rates, providing analytic control over the approximation quality.</p></li>
</ol>
</section>
</section>
<section id="discussion" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Discussion</h1>
<p>The present work develops a generative framework in which Multinomial Logit and Multinomial Probit arise as endpoint regimes of a single stochastic accumulation process. By introducing a Poisson count race and a temperature identification that separates noise scale from noise shape, this paper clarifies how extreme-value and Gaussian choice behavior emerge from different stopping rules applied to the same underlying mechanism. The goal is not to advocate replacing existing models, but to clarify their relationship: logit and probit correspond to distinct regimes of evidence accumulation, characterized by how much stochastic evidence is required before commitment.</p>
<p>The multinomial simulations demonstrate that this unification is not merely a theoretical curiosity. Thresholded accumulation induces systematic, graded violations of IIA that converge toward the dependence structure characteristic of multinomial probit. This dependence emerges endogenously from the accumulation and stopping rule, rather than being imposed by construction. The parameter invariance results further connect the framework to recent empirical findings <span class="citation" data-cites="Robinson2023">(<a href="#ref-Robinson2023" role="doc-biblioref"><strong>Robinson2023?</strong></a>)</span>, providing a process-level account of why Gaussian-based parameters exhibit greater stability across changes in set size.</p>
<section id="relation-to-existing-models" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="relation-to-existing-models"><span class="header-section-number">8.1</span> Relation to existing models</h2>
<p>From a mathematical standpoint, all components of the present framework are classical: exponential races yield Luce’s choice rule, Gamma waiting times arise from accumulated Poisson events, and asymptotic normality follows from the Central Limit Theorem. The contribution lies in assembling these elements into a single generative family and identifying the conditions under which its limiting behavior remains non-degenerate.</p>
<p>The present model should not be conflated with full sequential sampling models such as the Diffusion Decision Model <span class="citation" data-cites="Ratcliff1978">(<a href="#ref-Ratcliff1978" role="doc-biblioref"><strong>Ratcliff1978?</strong></a>)</span> or Linear Ballistic Accumulator <span class="citation" data-cites="BrownHeathcote2008">(<a href="#ref-BrownHeathcote2008" role="doc-biblioref"><strong>BrownHeathcote2008?</strong></a>)</span>. Those models jointly account for response times and accuracy via continuous accumulation with explicit drift and boundary parameters <span class="citation" data-cites="TownsendAshby1983 SmithVickers1988">(see also <a href="#ref-TownsendAshby1983" role="doc-biblioref"><strong>TownsendAshby1983?</strong></a>; <a href="#ref-SmithVickers1988" role="doc-biblioref"><strong>SmithVickers1988?</strong></a>)</span>. The Poisson count race is deliberately minimal: it uses accumulation as a generative device to induce a family of random utility models, without making claims about within-trial dynamics or response time distributions.</p>
<p>Between the logit and probit endpoints lies a continuum of log-Gamma random utility models. These intermediate regimes are not intended as new default specifications, but they underscore that logit and probit are special cases of a broader family. Deviations from logit or probit behavior may sometimes reflect differences in accumulation thresholds rather than fundamentally different noise sources.</p>
</section>
<section id="implications-for-empirical-modeling" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="implications-for-empirical-modeling"><span class="header-section-number">8.2</span> Implications for empirical modeling</h2>
<p>The present framework offers a theoretical account of why logit-based and probit-based models may differ in parameter invariance across task structures. Models with larger effective accumulation thresholds naturally exhibit Gaussian-like behavior, which may confer greater stability across changes in the number of alternatives. At the same time, the results caution against interpreting superior empirical performance of one model class as evidence for a particular noise distribution in isolation: differences between logit and probit may reflect differences in decision criteria or commitment thresholds rather than differences in representational noise per se.</p>
</section>
<section id="limitations-and-extensions" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="limitations-and-extensions"><span class="header-section-number">8.3</span> Limitations and extensions</h2>
<p>The Poisson count race is intentionally simple. It assumes independent accumulation processes and focuses exclusively on choice probabilities, abstracting away from response times and within-trial dynamics. Extensions that allow correlated accumulators, time-varying rates, or joint modeling of choice and response time are natural directions for future work.</p>
<p>The present analysis treats the accumulation threshold as fixed across trials and alternatives. Allowing threshold variability or adaptive stopping rules could further enrich the family of induced choice models and connect more directly to theories of decision caution and speed–accuracy trade-offs.</p>
<p>The model positions the Poisson count race as a parametric family indexed by <span class="math inline">\((\theta, \beta)\)</span>, but a formal identification analysis is beyond the present scope. In principle, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\beta\)</span> play distinct roles—shape versus scale of the noise distribution—and the shape of the psychometric function or the pattern of IIA violations could serve to identify <span class="math inline">\(\theta\)</span> from choice data. Whether these parameters are jointly identifiable from aggregate choice frequencies alone, and under what experimental designs, remains an open question for future investigation.</p>
<p>Finally, the framework naturally invites comparison with other random utility specifications. Exploring whether additional classical models arise as limiting regimes under alternative accumulation rules may provide further insight into the structure of discrete choice behavior.</p>
</section>
<section id="concluding-remarks" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="concluding-remarks"><span class="header-section-number">8.4</span> Concluding remarks</h2>
<p>By grounding discrete choice models in a common stochastic accumulation process, the Poisson count race reframes a long-standing modeling distinction. Logit and probit emerge not as competing assumptions about utility noise, but as endpoint regimes corresponding to different stopping rules applied to the same underlying mechanism. This unification clarifies their conceptual relationship and provides a principled basis for comparison, illustrating how process-level reasoning can illuminate the structure of static choice models.</p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hausmanConditionalProbitModel1978a" class="csl-entry" role="listitem">
Hausman, Jerry A., and David A. Wise. 1978. <span>“A <span>Conditional Probit Model</span> for <span>Qualitative Choice</span>: <span>Discrete Decisions Recognizing Interdependence</span> and <span>Heterogeneous Preferences</span>.”</span> <em>Econometrica</em> 46 (2): 403–26. <a href="https://doi.org/10.2307/1913909">https://doi.org/10.2307/1913909</a>.
</div>
<div id="ref-luceIndividualChoiceBehavior1959" class="csl-entry" role="listitem">
Luce, R. Duncan. 1959. <em>Individual Choice Behavior</em>. Individual Choice Behavior. Oxford, England: John Wiley.
</div>
<div id="ref-mcfaddenConditionalLogitAnalysis1974" class="csl-entry" role="listitem">
McFadden, Daniel. 1974. <span>“Conditional Logit Analysis of Qualitative Choice Behavior.”</span> In <em>Frontiers in Econometrics</em>, 105. Frontiers in Econometrics. - <span>New York</span> [u.a.] : <span>Academic Press</span>, <span>ISBN</span> 0-12-776150-0. - 1974, p. 105-142.
</div>
<div id="ref-robinsonHowPeopleBuild2023" class="csl-entry" role="listitem">
Robinson, Maria M., Isabella C. DeStefano, Edward Vul, and Timothy F. Brady. 2023. <span>“How Do People Build up Visual Memory Representations from Sensory Evidence? <span>Revisiting</span> Two Classic Models of Choice.”</span> <em>Journal of Mathematical Psychology</em> 117 (December): 102805. <a href="https://doi.org/10.1016/j.jmp.2023.102805">https://doi.org/10.1016/j.jmp.2023.102805</a>.
</div>
<div id="ref-thurstoneLawComparativeJudgment1927" class="csl-entry" role="listitem">
Thurstone, L. L. 1927. <span>“A Law of Comparative Judgment.”</span> <em>Psychological Review</em> 34 (4): 273–86. <a href="https://doi.org/10.1037/h0070288">https://doi.org/10.1037/h0070288</a>.
</div>
<div id="ref-yellottRelationshipLucesChoice1977" class="csl-entry" role="listitem">
Yellott, John. 1977. <span>“The Relationship Between <span>Luce</span>’s <span>Choice Axiom</span>, <span>Thurstone</span>’s <span>Theory</span> of <span>Comparative Judgment</span>, and the Double Exponential Distribution.”</span> <em>Journal of Mathematical Psychology</em> 15 (2): 109–44. <a href="https://doi.org/10.1016/0022-2496(77)90026-8">https://doi.org/10.1016/0022-2496(77)90026-8</a>.
</div>
</div>
</section>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>